/* Copyright 2023 Carlos A. (https://github.com/dealfonso); License: https://opensource.org/license/mit/ */
{var t=window;void 0===t&&(t={});let o="1.0.1",a={target:null,targetChildren:null,multiple:!0,joinText:"\n",images:!0,value:null,suppressWarnings:!0,debug:!1};function r(e,t={},o=""){""!=o&&(o+="-");var a,r={};for(a in t){var n=void 0,n=(n=(""+o+a).split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("")).charAt(0).toLowerCase()+n.slice(1);n in e.dataset?r[a]=e.dataset[n]:r[a]=t[a]}return r}function p(e){return!!e===e?e:+e===e?0!=e:""+e===e?"true"===e.toLowerCase():e}async function d(e){try{await navigator.clipboard.writeText(e)}catch(e){console.error("Failed to copy text to clipboard:",e)}}async function u(e){async function t(e,t=!1){async function o(a){let r=document.createElement("canvas"),e=r.getContext("2d");return r.width=a.naturalWidth||a.width,r.height=a.naturalHeight||a.height,e.drawImage(a,0,0),new Promise((t,o)=>{r.toBlob(e=>{r.remove(),n&&a.remove(),e?t(e):o(new Error("Failed to create blob from canvas"))},"image/png")})}let a=e,n=!1;return t?(n=!0,(a=new Image).crossOrigin="anonymous",a.src=e.src,new Promise((e,t)=>{a.onload=()=>o(a).then(e).catch(t),a.onerror=e=>t(new Error("Failed to load image: "+e.message))})):o(a)}let o=null;try{o=await t(e,!1)}catch(e){console.warn("Failed to get image without cross-origin; we'll try to download it again\n",e)}try{if(!(o=o||await t(e,!0)))throw new Error("Blob creation failed");var a=new ClipboardItem({[o.type]:o});try{await navigator.clipboard.write([a])}catch(e){console.error("Failed to copy image to clipboard:",e)}}catch(e){console.error("Failed to fetch image:",e)}}function n(e,l={}){l=Object.assign({},a,l);let s=e=>e,c=e=>e,t=(p(l.suppressWarnings)||(s=(...e)=>console.warn(...e)),p(l.debug)&&(c=(...e)=>console.log(...e)),[]);if("string"==typeof e?t=document.querySelectorAll(e):e instanceof HTMLElement&&(t=[e]),0===t.length)s("No elements found to make copyable:",e);else{t instanceof NodeList||t instanceof HTMLCollection?t=Array.from(t):Array.isArray(t)||(t=[t]);for(let i of t){let n=r(i,l,"copy"),e;s=e=>e,p(n.suppressWarnings)||(s=e=>console.warn(e)),c=e=>e,p(n.debug)&&(c=(...e)=>console.log(...e)),n.target||n.targetChildren||n.value?(i._copyClipboard&&(i.removeEventListener("click",i._copyClipboard.copyHandler),delete i._copyClipboard),e=function(){let e=[];if(n.value)l.images&&l.value instanceof File&&l.value.type.startsWith("image/")?(t=new ClipboardItem({[l.value.type]:l.value}),navigator.clipboard.write([t]).then(()=>{c("Image copied from file to clipboard.")}).catch(e=>{console.error("Failed to copy image:",e)})):"string"==typeof l.value||"number"==typeof l.value?d(l.value):l.value instanceof HTMLElement?d(l.value.innerText||l.value.textContent):Array.isArray(l.value)?d(l.value.join("\n")):s(`Unsupported value type for copying: ${typeof l.value}. Expected string, number, HTMLElement or array.`);else{var t=n.target?document.querySelectorAll(n.target):[],o=n.targetChildren?i.querySelectorAll(n.targetChildren):[];if(0===(t=[...t,...o]).length)s(`No target elements found for selector: ${n.target} or children selector: ${n.targetChildren}.`);else{p(n.multiple)?(e=Array.from(t),c("Copying all target elements: ",e)):(e=[t[0]],c("Copying only the first target element: "+e[0]));var a,r=[];for(a of e){if(p(n.images)&&"img"===a.tagName.toLowerCase())return void u(a);"input"===a.tagName.toLowerCase()||"textarea"===a.tagName.toLowerCase()?r.push(a.value||""):"select"===a.tagName.toLowerCase()?r.push(a.options[a.selectedIndex].text||""):"img"===a.tagName.toLowerCase()?r.push(a.alt||a.title||a.src||""):r.push(a.innerText||a.textContent||a.value||a.text||a.alt||"")}0<r.length&&d(r.join(n.joinText))}}},i._copyClipboard={options:n,copyHandler:e,version:o},i.addEventListener("click",e)):s("Nothing to copy for element:",i)}}}function i(e,t={}){t=Object.assign({},{onPasteImage:e=>{},onPasteText:e=>{},onError:e=>console.error(e)},t);var o=e.clipboardData||window.clipboardData;if(!o)return"function"==typeof t.onError&&t.onError("No clipboard data available. Please ensure you have copied something to the clipboard before pasting."),!1;if(!o.items)return(e=o.getData("Text"))?("function"==typeof t.onPasteText&&t.onPasteText(e),!0):("function"==typeof t.onError&&t.onError("No text data found in clipboard data. Please ensure you have copied text to the clipboard before pasting."),!1);for(var a=0;a<o.items.length;a++){var r,n=o.items[a];if("file"===n.kind&&n.type.startsWith("image/"))return(r=n.getAsFile())?("function"==typeof t.onPasteImage&&t.onPasteImage(r),!0):("function"==typeof t.onError&&t.onError("No file found in clipboard data. Please ensure you have copied an image to the clipboard before pasting."),!1);if("string"===n.kind&&"text/plain"===n.type)return n.getAsString(function(e){"function"==typeof t.onPasteText&&t.onPasteText(e)}),!0}}navigator.permissions.query({name:"clipboard-write"}).then(e=>{"granted"===e.state||"prompt"===e.state?t.copyClipboard=n:(console.warn("Clipboard write permission is not granted. Cannot make elements copyable."),t.copyClipboard=function(){console.warn("Clipboard write permission is not granted. Cannot make elements copyable.")}),t.copyClipboard.version=o,t.copyClipboard.copyTextToClipboard=d,t.copyClipboard.copyImageToClipboard=u,t.copyClipboard.handlePaste=i}),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-copy-target],[data-copy-value],[data-copy-target-children]").forEach(e=>{n(e,r(e,a,"copy"))})})}